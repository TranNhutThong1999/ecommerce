<html xmlns:th="http://www.thymeleaf.org">
<head>
<div th:replace="common/Css.html"></div>
<meta charset="UTF-8">
<title>Trang chủ</title>
</head>
<body>
	<div id="page">
		<!-- Menu -->
		<div th:replace="common/Menu.html"></div>
		<!-- Begin Main -->
		<div role="main" class="main">
			<!-- Begin Main Slide -->
			<section class="main-slide">
				<div id="owl-main-slide" class="owl-carousel pgl-main-slide"
					data-plugin-options='{"autoPlay": true}' >
					<div class="item" th:id="${'item'+(i.index+1)}" th:each="Post,i : ${Posts}" th:if="${i.index}<3">
						<img th:src="@{${'/images/slides/slider'+(i.index+1)+'.jpg'}}" alt="Photo"
							class="img-responsive">
						<div class="item-caption">
							<div class="container">
								<div class="property-info">
									<span class="property-thumb-info-label"> <span
										class="label price" th:text="${Post.content.price}">$358,000</span> <span class="label"><a
											th:href="@{${'/posts/'+ Post.id}}" class="btn-more">Thông tin
												thêm</a></span>
									</span>
									<div class="property-thumb-info-content">
										<h2>
											<a  ><span th:text="${Post.title}"></span>, <span th:text="${Post.content.areage}"></span><sup>m2</sup></a>
										</h2>
										<p><span
										th:text="${Post.address.ward.name}+', '+ ${Post.address.district.name}+', '+ ${Post.address.provincial.name}"></span></p>
									</div>
								</div>
							</div>
						</div>
					</div>
				
				</div>
			</section>
			<!-- End Main Slide -->

			<!-- Begin Advanced Search -->

			<!-- End Advanced Search -->

			<!-- Begin Featured -->
			<section class="pgl-featured pgl-bg-grey">
				<div class="container"  style="border-top: 1px solid #0000001f;">
					<div class="row" style="margin-top: 55px;">
						<div class="col-md-6 animation">
							<div class="pgl-property featured-item">
								<div class="property-thumb-info">
									<div class="property-thumb-info-image">
										<img alt="" class="img-responsive"
											th:src="@{images/properties/property-featured-1.jpg}" />">
									</div>
									<div class="property-thumb-info-content">
										<h3>
											<a href="property-detail.html">Alpine Rd, Stockton, CA
												95215</a>
										</h3>
										<p>Amet luctus nisl tempus.</p>
									</div>
								</div>
							</div>
						</div>
						<div class="col-xs-6 col-md-3 animation">
							<div class="pgl-property featured-item">
								<div class="property-thumb-info">
									<div class="property-thumb-info-image">
										<img alt="" class="img-responsive"
											th:src="@{images/properties/property-featured-2.jpg}">
									</div>
									<div class="property-thumb-info-content">
										<h3>
											<a href="property-detail.html">J St, Modesto, CA 95351</a>
										</h3>
										<p>Amet luctus nisl tempus.</p>
									</div>
								</div>
							</div>
						</div>
						<div class="col-xs-6 col-md-3 animation">
							<div class="pgl-property featured-item">
								<div class="property-thumb-info">
									<div class="property-thumb-info-image">
										<img alt="" class="img-responsive"
											th:src="@{images/properties/property-featured-3.jpg}">
									</div>
									<div class="property-thumb-info-content">
										<h3>
											<a href="property-detail.html">Spring Gate DrUNIT 4106</a>
										</h3>
										<p>Amet luctus nisl tempus.</p>
									</div>
								</div>
							</div>
						</div>
						<div class="col-xs-6 col-md-3 animation">
							<div class="pgl-property featured-item">
								<div class="property-thumb-info">
									<div class="property-thumb-info-image">
										<img alt="" class="img-responsive"
											th:src="@{images/properties/property-featured-4.jpg}">
									</div>
									<div class="property-thumb-info-content">
										<h3>
											<a href="property-detail.html">Chatham St NW, Roanoke</a>
										</h3>
										<p>Amet luctus nisl tempus.</p>
									</div>
								</div>
							</div>
						</div>
						<div class="col-xs-6 col-md-3 animation">
							<div class="pgl-property featured-item">
								<div class="property-thumb-info">
									<div class="property-thumb-info-image">
										<img alt="" class="img-responsive"
											th:src="@{images/properties/property-featured-5.jpg}">
									</div>
									<div class="property-thumb-info-content">
										<h3>
											<a href="property-detail.html">Stockton, CA 95215</a>
										</h3>
										<p>Amet luctus nisl tempus.</p>
									</div>
								</div>
							</div>
						</div>
					</div>
					<hr class="top-tall">
				</div>
			</section>
			<!-- End Featured -->

			<!-- Begin Properties -->
			<section class="pgl-properties pgl-bg-grey">
				<div class="container">
					<h2>Danh sách</h2>
					<!-- Nav tabs -->
					<!-- Tab panes -->
					<div class="tab-content">
						<div class="tab-pane active" id="all">
							<div class="row">
								<div class="col-xs-4 animation" th:each="Post,i : ${Posts}" th:if="${i.index >2 && i.index<9 }" > <!--  -->
									<div class="pgl-property">
										<div class="property-thumb-info">
											<div class="property-thumb-info-image">
												<img alt="" class="img-responsive"
													th:src="@{${Post.images[0].name}}" style="width:396px;height:264px;"/> <span
													class="property-thumb-info-label"> <span
													class="label price" th:text="${Post.content.price}">$358,000</span>
												</span>
											</div>
											<div class="property-thumb-info-content">
												<h3>
													<a th:href="@{${'/posts/'+Post.id}}" th:text="${Post.title}">Poolside character home
														on a wide 422sqm</a>
												</h3>
												<address><span
										th:text="${Post.address.location}+','+${Post.address.ward.name}+','+ ${Post.address.district.name}+', '+ ${Post.address.provincial.name}"></span></p>
												</address>
												 <i class='far fa-eye'></i>  <span th:text="${Post.view}"></span>
											</div>
											<div class="amenities clearfix">
												<ul class="pull-left">
													<li><strong>Diện tích</strong> <span th:text="${Post.content.areage}"></span><sup>m2</sup></li>
												</ul>
													<span sec:authorize="isAuthenticated()" class="label forrent pull-right" th:classappend="${#lists.contains(Post.idUserlike,#authentication.getPrincipal().id) ? 'activeLike':''}"> <a th:onclick="'mySave('+${Post.id}+')'" th:text="${#lists.contains(Post.idUserlike,#authentication.getPrincipal().id)?'Hủy lưu':'Lưu tin' }" >Lưu
													Tin</a></span>
									
									<span sec:authorize="isAnonymous()" class="label forrent pull-right" > <a th:onclick="'mySave('+${Post.id}+')'"  >Lưu
													Tin</a></span>
									</span>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

				</div>
			</section>
			<!-- End Properties -->

		</div>
		<!-- End Main -->
		<div th:replace="common/Footer.html"></div>
		<!-- Begin footer -->

	</div>
	<div th:replace="common/Js.html"></div>
	<script th:inline="javascript">
	$(document).ready(function(){
		let message = [[${message != null ? message : 0}]]
		if(message === 'login'){
			Notiflix.Notify.Success('Đăng nhập thành công',{
				/* clickToClose:true,
				closeButton:true */
			});
		}
		 $(".price").each(function (index) {
	          converIntToMoney(this);
	        });
	        function converIntToMoney(parameter) {
	          let value = $(parameter).text();
	          let nf = Intl.NumberFormat();
	          let money = nf.format(value);
	          if(money == '0'){
	        	  $(parameter).text(money + "đ");
	        	  return;
	          }
	          $(parameter).text(money + "đ");
	        }
	        
	        window.mySave = (i) => {
	        	let auth =[[${#authentication.name != 'anonymousUser' ? #authentication.getPrincipal().id : 0}]]
	        	if(auth == 0){
	        		Notiflix.Confirm.Show(
	        				'Thông báo','Vui lòng đăng nhập để lưu bài viết?','Đồng ý','Không đồng ý',
	        				function(){ 
	        					window.location.href = [[${#httpServletRequest.getContextPath()}]]+'/login'
	        				},
							function(){ 
	        					console.log("no")
	        				},
	        		)
	        	}else{
	        		$.ajax({
		        		url:'/like',
		        		type:'put',
		        		data:{
		        			idPost: i
		        		},
		        		success:function(value){
		        			console.log(value)
		        				window.location.reload()
		        		},
		        		error:function(err){
		        			
		        		}
		        	})
	        	}
	        
	        }
})
	</script>
</body>
</html>